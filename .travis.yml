language: node_js
sudo: required
node_js:
  - "8"
addons:
  apt:
    sources:
    - ubuntu-toolchain-r-test
    - llvm-toolchain-precise-3.5
    packages:
    - libstdc++6
      # This is required to run new chrome on old trusty
    - libnss3

before_script:
    - TEST=true npm run build


deploy: #update translation strings on transifex
    provider: script
    skip_cleanup: true
    script:
        - npm run build
        - npm run i18n
        - pip install virtualenv
        - virtualenv ~/env
        - source ~/env/bin/activate
        - pip install transifex-client
        - sudo echo $'[https://www.transifex.com]\nhostname = https://www.transifex.com\nusername = '"$TRANSIFEX_API_USER"$'\npassword = '"$TRANSIFEX_API_KEY"$'\n' > ~/.transifexrc
        - tx push -st

    on:
      branch: master
